type YieldClaimedSnapshot @entity(timeseries: true) {
  id: Int8!
  timestamp: Timestamp!
  amount: BigInt!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
  logIndex: BigInt!
}

type ReceivedSnapshot @entity(immutable: true) {
  id: ID! @unique
  timestamp: Timestamp!
  account: Holder!
  amount: BigInt!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
  logIndex: BigInt!
}

type SentSnapshot @entity(immutable: true) {
  id: ID! @unique
  timestamp: Timestamp!
  account: Holder!
  amount: BigInt!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
  logIndex: BigInt!
}

type Holder @entity(immutable: false) {
  id: Bytes! @unique
  received: BigInt!
  receivedSnapshots: [ReceivedSnapshot!] @derivedFrom(field: "account")
  sent: BigInt!
  sentSnapshots: [SentSnapshot!] @derivedFrom(field: "account")
  lastUpdate: Timestamp!
}

type MintedSnapshot @entity(timeseries: true) {
  id: Int8!
  timestamp: Timestamp!
  amount: BigInt!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
  logIndex: BigInt!
}

type BurnedSnapshot @entity(timeseries: true) {
  id: Int8!
  timestamp: Timestamp!
  amount: BigInt!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
  logIndex: BigInt!
}

type StablecoinSupply @entity(timeseries: true) {
  id: Int8!
  timestamp: Timestamp!
  amount: BigInt!
  stablecoin: Stablecoin!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
  logIndex: BigInt!
  delta: BigInt!
  operation: Operation!
}

enum Operation {
  MINT
  BURN
}

type Stablecoin @entity(immutable: false) {
  id: Bytes! @unique # address
  holders: [Holder!]
  transfers: [Transfer!]
  yieldClaimed: BigInt!
  yieldClaimedSnapshots: [YieldClaimedSnapshot!]
  minted: BigInt!
  mintedSnapshots: [MintedSnapshot!]
  burned: BigInt!
  burnedSnapshots: [BurnedSnapshot!]
  lastUpdate: Timestamp!
}

type Transfer @entity(immutable: true) {
  id: Bytes!
  sender: Bytes! # address
  recipient: Bytes! # address
  amount: BigInt! # uint256
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}
