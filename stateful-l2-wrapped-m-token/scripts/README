# Script usage

The script in this folder expects this subgraph to be deployed and uses its data to compute accrued yield for a given earner.

```bash
$ node ./scripts/periodic-yield.js <ADDRESS> <LATEST_EOD_TIMESTAMP> <PERIODS> <SECONDS_PER_PERIOD>
```

-   `ADDRESS` is a case-insensitive WrappedM holder address
-   `LATEST_EOD_TIMESTAMP` is the Unix/block timestamp that demarcates the end of the most recent period
-   `PERIODS` is the number of recent periods to return earned yield values for
-   `SECONDS_PER_PERIOD` defines how long a period is in seconds

## Examples

Notice that this Indexer is meant for our Spoke networks. We don't push rate information to spoke networks on `IndexUpdates`. The script gets the rate information from the [`stateful-m-token` subgraph](../../stateful-m-token).

You'll need to deploy both subgraphs to use it. Alternatively, you can hardcode the rate value in if all you need is the total accrued yield (check the second example below).

1. Set env vars

    ```sh
    cp .env.example .env
    ```

1. Run the script

    Example: Daily yields of [USDai](https://dashboard.m0.org/stablecoins/usdai) from 13 May 2026 to 19 Aug 2026.

    ```sh
    yarn run:script \
        0x0A1a1A107E45b7Ced86833863f482BC5f4ed82EF \
        1755618977 \
        99 \
        86400
    ```

    Example: Total accrued yield for [USDai](https://dashboard.m0.org/stablecoins/usdai) until 19 Aug 2026.

    ```sh
    yarn run:script \
        0x0A1a1A107E45b7Ced86833863f482BC5f4ed82EF \
        1755618977 \
        1 \
        8500210
    ```
